@extends('layouts.app')
@section('title')
{{ __('WAXP EARN') }}
@endsection

@section('content')
    <link href="{{ asset('assets/css/earn.css') }}" rel="stylesheet" type="text/css" />

    <div class="contaner" style="margin-top: 200px;">
        <div class="row" style="display: flex;justify-content:center;">
            <div class="col-sm-8">
                <p style="font-size: 30px">Featured Offers</p>
            </div>
        </div>
        <div class="row" style="display: flex;justify-content:center;">
            <div class="col-sm-10">
                <div class="econtainer">
                    <div id="slide-left-container">
                        <div class="slide-left">
                        </div>
                    </div>
                    <div id="ecards-container">
                        <div class="ecards">
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                            <div class="ecard">
                                <div class="center">
                                    <img class="ecard-img " src="{{ asset('assets/images/offer_partners/sample.png') }}"
                                        alt="Animals">
                                </div>
                                <div class="center">
                                    <p>Animals</p>
                                </div>
                                <div class="center">
                                    <p>0.03$</p>
                                </div>
                                <div class="center">
                                    <p>Game</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="slide-right-container">
                        <div class="slide-right">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row center">
            <div class="col-sm-10">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="center">
                            <p style="font-size: 30px">Offer Partners</p>
                        </div>
                        <div class="row">
                            <div id="ecards-container">
                                <div class="ecards center">
                                    <div class="pcard" id="pt_lootably" onclick="show_offerwall('lootably')">
                                        <img class="pcard-img "
                                            src="{{ asset('assets/images/offer_partners/lootably.png') }}"
                                            alt="Animals">
                                    </div>
                                    <div class="pcard" id="pt_notik" onclick="show_offerwall('notik')">
                                        <img class="pcard-img "
                                            src="{{ asset('assets/images/offer_partners/notik.png') }}" alt="Animals">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="center">
                            <p style="font-size: 30px">Survey Partners</p>
                        </div>
                        <div class="row">
                            <div id="ecards-container">
                                <div class="ecards center">
                                    <div class="pcard" id="pt_lootably" onclick="show_offerwall('lootably')">
                                        <img class="pcard-img "
                                            src="{{ asset('assets/images/offer_partners/lootably.png') }}"
                                            alt="Animals">
                                    </div>
                                    <div class="pcard" id="pt_notik" onclick="show_offerwall('notik')">
                                        <img class="pcard-img "
                                            src="{{ asset('assets/images/offer_partners/notik.png') }}" alt="Animals">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--modal-->
    <div class="offerwall_modal" id="offerwall_modal">
        <div class="offerwall_header">
            <p id="offerwall_title">Modal Heading</p>
            <button type="button" onclick="hide_offerwall()">×</button>
        </div>
        <div class="offerwall_body">
            <iframe src="" id="iframe"></iframe>
        </div>
    </div>


    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
    <script>
        function updateSliderArrowsStatus(
            ecardsContainer,
            containerWidth,
            ecardCount,
            ecardWidth
        ) {
            if (
                $(ecardsContainer).scrollLeft() + containerWidth <
                ecardCount * ecardWidth + 15
            ) {
                $("#slide-right-container").addClass("active");
            } else {
                $("#slide-right-container").removeClass("active");
            }
            if ($(ecardsContainer).scrollLeft() > 0) {
                $("#slide-left-container").addClass("active");
            } else {
                $("#slide-left-container").removeClass("active");
            }
        }
        $(function() {
            // Scroll products' slider left/right
            let div = $("#ecards-container");
            let ecardCount = $(div)
                .find(".ecards")
                .children(".ecard").length;
            let speed = 500;
            let containerWidth = $(".container").width();
            let ecardWidth = 250;

            updateSliderArrowsStatus(div, containerWidth, ecardCount, ecardWidth);

            //Remove scrollbars
            $("#slide-right-container").click(function(e) {
                if ($(div).scrollLeft() + containerWidth < ecardCount * ecardWidth) {
                    $(div).animate({
                        scrollLeft: $(div).scrollLeft() + ecardWidth
                    }, {
                        duration: speed,
                        complete: function() {
                            setTimeout(
                                updateSliderArrowsStatus(
                                    div,
                                    containerWidth,
                                    ecardCount,
                                    ecardWidth
                                ),
                                1005
                            );
                        }
                    });
                }
                updateSliderArrowsStatus(div, containerWidth, ecardCount, ecardWidth);
            });
            $("#slide-left-container").click(function(e) {
                if ($(div).scrollLeft() + containerWidth > containerWidth) {
                    $(div).animate({
                        scrollLeft: "-=" + ecardWidth
                    }, {
                        duration: speed,
                        complete: function() {
                            setTimeout(
                                updateSliderArrowsStatus(
                                    div,
                                    containerWidth,
                                    ecardCount,
                                    ecardWidth
                                ),
                                1005
                            );
                        }
                    });
                }
                updateSliderArrowsStatus(div, containerWidth, ecardCount, ecardWidth);
            });

            // If resize action ocurred then update the container width value
            $(window).resize(function() {
                try {
                    containerWidth = $("#ecards-container").width();
                    updateSliderArrowsStatus(div, containerWidth, ecardCount, ecardWidth);
                } catch (error) {
                    console.log(
                        `Error occured while trying to get updated slider container width: 
                ${error}`
                    );
                }
            });
        });

        var offer_modal = document.getElementById("offerwall_modal");
        var iframe = document.getElementById("iframe");
        var offerwall_title = document.getElementById("offerwall_title");

        /* function show_offerwall(partner) {
            offer_modal.style.visibility = "visible";
            offerwall_title.innerHTML = partner + " Offer Wall";
            $.post("get_iframe", {
                    _token: $('meta[name="csrf-token"]').attr('content'),
                    partner: partner
                },
                function(data, status) {
                    iframe.srcdoc = data;
                }
            );
        } */
        function show_offerwall(partner)
        {
          offer_modal.style.visibility = "visible";
          offerwall_title.innerHTML = partner+" Offer Wall";
          let url = "";
          if(partner == "lootably")
          {
            url = "https://wall.lootably.com/?placementID=clhedla0e0oh101uy7xwj55vz&sid=";     
            
          }
          else if(partner == "notik")
          {
            url = "https://notik.me/coins?api_key=tM9z2VjFRUGQ2iBdVZy43suBlzVl4a3t&pub_id=pO8AAu&app_id=ENRGtwfmUd&user_id=";
          }
          url += {{ $user_id }};
          iframe.src = url; 
          iframe.src += ''; 
        }
        function hide_offerwall() {
            iframe.src = 'about:blank';
            iframe.src += '';
            offer_modal.style.visibility = "hidden";
        }


        $(document).ready(function() {
            /* $.post("get_notik_offers", {
                _token : $('meta[name="csrf-token"]').attr('content'),
              },
              function(data, status){
                console.log("Data: " + data + "\nStatus: " + status);
              }
            ); */
        });
        
    </script>
@endsection
